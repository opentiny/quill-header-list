{"version":3,"file":"index.umd.js","names":["b: string","n: string","e?: string","m?: string","s?: string","v?: string","n","fn: () => void","delay: number","timeoutId: ReturnType<typeof setTimeout>","val: unknown","val: T | T[]","value: HeaderValue | number","domNode: HTMLElement","headerListSvg","quill: Quill","options: InputHeaderListOptions","Quill","resultTopOffset: () => Promise<number> | number","#lastTopOffset","newHeaders: (HeaderRecord & { index: number })[]","modifiedHeaders: HTMLElement[]","container: HTMLElement | Window","header: HTMLElement | null","Header","id: string","text: string","level: number","addHeaders: (HeaderRecord & { index: number })[]","removeHeaders: HTMLElement[]","element: HTMLElement","container: HTMLElement"],"sources":["../src/utils/constants.ts","../src/utils/bem.ts","../src/utils/functions.ts","../src/utils/id.ts","../src/utils/is.ts","../src/formats/header.ts","../src/svg/header-list.svg","../src/index.ts"],"sourcesContent":["export const cssNamespace = 'hl';\r\n","import { cssNamespace } from './constants';\r\n\r\nexport function createBEM(b: string, n: string = cssNamespace) {\r\n  const prefix = n ? `${n}-` : '';\r\n  return {\r\n    /** n-b */\r\n    b: () => `${prefix}${b}`,\r\n    /** n-b__e */\r\n    be: (e?: string) => e ? `${prefix}${b}__${e}` : '',\r\n    /** n-b--m */\r\n    bm: (m?: string) => m ? `${prefix}${b}--${m}` : '',\r\n    /** n-b__e--m */\r\n    bem: (e?: string, m?: string) => e && m ? `${prefix}${b}__${e}--${m}` : '',\r\n    /** n-s */\r\n    ns: (s?: string) => s ? `${prefix}${s}` : '',\r\n    /** n-b-s */\r\n    bs: (s?: string) => s ? `${prefix}${b}-${s}` : '',\r\n    /** --n-v */\r\n    cv: (v?: string) => v ? `--${prefix}${v}` : '',\r\n    /** is-n */\r\n    is: (n: string) => `is-${n}`,\r\n  };\r\n}\r\n","export function throttleAndDebounce(fn: () => void, delay: number): () => void {\r\n  let timeoutId: ReturnType<typeof setTimeout>;\r\n  let called = false;\r\n\r\n  return () => {\r\n    if (timeoutId) clearTimeout(timeoutId);\r\n\r\n    if (!called) {\r\n      fn();\r\n      called = true;\r\n      setTimeout(() => (called = false), delay);\r\n    }\r\n    else {\r\n      timeoutId = setTimeout(fn, delay);\r\n    }\r\n  };\r\n}\r\n","export const randomID = () => Math.random().toString(36).slice(2, 8);\r\n","export const isFunction = (val: unknown): val is (...args: any[]) => any => typeof val === 'function';\r\nexport const isString = (val: unknown): val is string => typeof val === 'string';\r\nexport const isUndefined = (val: unknown): val is undefined => val === undefined;\r\nexport const isNumber = (val: unknown): val is number => typeof val === 'number';\r\nexport const isArray = Array.isArray;\r\nexport const ensureArray = <T>(val: T | T[]): T[] => isArray(val) ? val : [val];\r\n","import type TypeBlock from 'quill/blots/block';\r\nimport type { HeaderValue } from '../utils';\r\nimport Quill from 'quill';\r\nimport { isNumber, randomID } from '../utils';\r\n\r\nconst Header = Quill.import('formats/header') as typeof TypeBlock;\r\n\r\nexport class HeaderWithID extends Header {\r\n  static idKey = 'data-block-id';\r\n  static create(value: HeaderValue | number) {\r\n    let id;\r\n    if (isNumber(value)) {\r\n      id = randomID();\r\n    }\r\n    else {\r\n      id = value.id || randomID();\r\n      value = value.value || 0;\r\n    }\r\n    const node = super.create(value);\r\n    node.setAttribute(this.idKey, id);\r\n    return node;\r\n  }\r\n\r\n  static formats(domNode: HTMLElement): Record<string, any> {\r\n    const value = this.tagName.indexOf(domNode.tagName) + 1;\r\n    const id = domNode.getAttribute(this.idKey) || randomID();\r\n    return {\r\n      id,\r\n      value,\r\n    };\r\n  }\r\n\r\n  get id() {\r\n    let value = this.domNode.getAttribute(this.statics.idKey);\r\n    if (!value) {\r\n      value = randomID();\r\n      this.domNode.setAttribute(this.statics.idKey, value);\r\n    }\r\n    return value;\r\n  }\r\n}\r\n","\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\">\\n  <path\\n    fill=\\\"currentColor\\\"\\n    fill-rule=\\\"evenodd\\\"\\n    d=\\\"M19.6 2H8.4A2.4 2.4 0 0 0 6 4.4v11.2A2.4 2.4 0 0 0 8.4 18h11.2a2.4 2.4 0 0 0 2.4-2.4V4.4A2.4 2.4 0 0 0 19.6 2M9 7a1 1 0 0 1 1-1h8a1 1 0 1 1 0 2h-8a1 1 0 0 1-1-1m1 2a1 1 0 0 0 0 2h8a1 1 0 1 0 0-2zm-1 4a1 1 0 0 1 1-1h4a1 1 0 1 1 0 2h-4a1 1 0 0 1-1-1\\\"\\n    clip-rule=\\\"evenodd\\\"\\n  />\\n  <path\\n    fill=\\\"currentColor\\\"\\n    d=\\\"M4 4a1 1 0 0 0-2 0v11.6C2 19.132 4.868 22 8.4 22H20a1 1 0 1 0 0-2H8.4A4.403 4.403 0 0 1 4 15.6z\\\"\\n  />\\n</svg>\\n\"","import type TypeToolbar from 'quill/modules/toolbar';\r\nimport Quill from 'quill';\r\nimport { HeaderWithID } from './formats';\r\nimport headerListSvg from './svg/header-list.svg';\r\nimport { createBEM, ensureArray, isFunction, isNumber, isString, throttleAndDebounce } from './utils';\r\n\r\nexport interface HeaderListOptions {\r\n  container: HTMLElement;\r\n  scrollContainer: HTMLElement | undefined;\r\n  hideClass: string;\r\n  topOffset: () => number | Promise<number>;\r\n  headerHeight: number;\r\n  onBeforeShow: () => boolean | Promise<boolean>;\r\n  onBeforeHide: () => boolean | Promise<boolean>;\r\n  onItemClick: (id: string) => void;\r\n}\r\nexport type InputHeaderListOptions = Partial<Omit<HeaderListOptions, 'container' | 'scrollContainer'>> & {\r\n  container: HTMLElement | string;\r\n  scrollContainer: HTMLElement | string;\r\n};\r\nexport interface HeaderRecord {\r\n  el: HTMLElement;\r\n  blot: HeaderWithID;\r\n}\r\nexport class HeaderList {\r\n  static moduleName = 'header-list';\r\n  static toolName = 'header-list';\r\n  static toolbarHandle = async function (this: TypeToolbar) {\r\n    const headerListModule = this.quill.getModule(HeaderList.moduleName) as HeaderList;\r\n    if (!headerListModule) return;\r\n    headerListModule.toggleDisplay();\r\n  };\r\n\r\n  static register() {\r\n    const icons = Quill.import('ui/icons') as Record<string, string>;\r\n    icons[HeaderList.toolName] = headerListSvg;\r\n\r\n    Quill.register({\r\n      'formats/header': HeaderWithID,\r\n    }, true);\r\n  }\r\n\r\n  scrollContainerListener = throttleAndDebounce(this.handleScroll.bind(this), 100);\r\n  editorHeaders: (HeaderRecord & { text: string })[] = [];\r\n  isHidden: boolean = false;\r\n  bem = createBEM('header-list');\r\n  root?: HTMLElement;\r\n  options: HeaderListOptions;\r\n  highlightedItem?: Element;\r\n  #lastTopOffset: number = 0;\r\n  constructor(public quill: Quill, options: InputHeaderListOptions) {\r\n    this.options = this.resolveOptions({ ...options });\r\n    if (this.options.container) {\r\n      this.hide();\r\n      this.root = this.buildList();\r\n      this.options.container.appendChild(this.root);\r\n\r\n      this.quill.on(Quill.events.TEXT_CHANGE, throttleAndDebounce(() => this.updateHeaders(), 500));\r\n      this.quill.on(Quill.events.EDITOR_CHANGE, () => {\r\n        const [range] = this.quill.selection.getRange();\r\n        if (range === null) {\r\n          this.activeToolbarControl();\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      console.warn('header-list: options.container is required');\r\n    }\r\n  }\r\n\r\n  resolveOptions(options: InputHeaderListOptions): HeaderListOptions {\r\n    const container = isString(options.container) ? document.getElementById(options.container) : options.container;\r\n    let scrollContainer = options.scrollContainer\r\n      ? isString(options.scrollContainer)\r\n        ? document.getElementById(options.scrollContainer)\r\n        : options.scrollContainer\r\n      : this.quill.root;\r\n    // @ts-ignore\r\n    if (scrollContainer === window || scrollContainer === document.documentElement) {\r\n      scrollContainer = null;\r\n    }\r\n\r\n    let resultTopOffset: () => Promise<number> | number;\r\n    const inputTopOffset = options.topOffset;\r\n    if (isFunction(inputTopOffset)) {\r\n      resultTopOffset = inputTopOffset;\r\n    }\r\n    else if (isNumber(inputTopOffset)) {\r\n      resultTopOffset = () => inputTopOffset;\r\n    }\r\n    else {\r\n      resultTopOffset = () => 0;\r\n    }\r\n\r\n    return Object.assign({\r\n      hideClass: this.bem.is('hidden'),\r\n      headerHeight: 36,\r\n      onBeforeShow: () => false,\r\n      onBeforeHide: () => false,\r\n      onItemClick: () => {},\r\n      container,\r\n    }, { ...options }, {\r\n      scrollContainer,\r\n      topOffset: async () => {\r\n        let offset = await resultTopOffset();\r\n        offset = Number.isNaN(Number(offset)) ? 0 : offset;\r\n        if (this.#lastTopOffset !== offset) {\r\n          this.#lastTopOffset = offset;\r\n        }\r\n        return offset;\r\n      },\r\n    });\r\n  }\r\n\r\n  updateHeaders() {\r\n    const currentHeaders = Array.from(\r\n      this.quill.root.querySelectorAll<HTMLElement>(\r\n        ':scope > h1, :scope > h2, :scope > h3, :scope > h4, :scope > h5, :scope > h6',\r\n      ),\r\n    )\r\n      .map(el => ({\r\n        el,\r\n        blot: this.quill.scroll.find(el) as HeaderWithID,\r\n      }))\r\n      .filter(item => item.blot);\r\n    const removedHeaders = this.editorHeaders.map(item => item.el).filter(item => !currentHeaders.some(header => header.el === item));\r\n    const newHeaders: (HeaderRecord & { index: number })[] = [];\r\n    const modifiedHeaders: HTMLElement[] = [];\r\n    for (const [index, header] of currentHeaders.entries()) {\r\n      if (!this.editorHeaders.some(item => item.el === header.el)) {\r\n        newHeaders.push({ ...header, index });\r\n      }\r\n      else if (this.editorHeaders.some(({ el, text }) => el === header.el && text !== header.el.textContent)) {\r\n        modifiedHeaders.push(header.el);\r\n      }\r\n    }\r\n\r\n    this.update(newHeaders, removedHeaders, modifiedHeaders);\r\n    this.editorHeaders = currentHeaders.map(header => ({ ...header, text: header.el.textContent || '' }));\r\n  }\r\n\r\n  bindScrollListener() {\r\n    let container: HTMLElement | Window = window;\r\n    if (this.options.scrollContainer) {\r\n      container = this.options.scrollContainer;\r\n    }\r\n    container.addEventListener('scroll', this.scrollContainerListener);\r\n  }\r\n\r\n  removeScrollListener() {\r\n    let container: HTMLElement | Window = window;\r\n    if (this.options.scrollContainer) {\r\n      container = this.options.scrollContainer;\r\n    }\r\n    container.removeEventListener('scroll', this.scrollContainerListener);\r\n  }\r\n\r\n  async handleScroll() {\r\n    if (!this.root) return;\r\n    let header: HTMLElement | null = this.editorHeaders[0]?.el || null;\r\n    const container = this.options.scrollContainer || document.documentElement;\r\n    const topOffset = await this.options.topOffset();\r\n    const scrollTop = container.scrollTop;\r\n    const offsetParent = this.options.scrollContainer?.offsetParent || document.body;\r\n\r\n    const headers = this.editorHeaders\r\n      .map(({ el }) => ({ el, top: getAbsoluteTop(el, offsetParent as HTMLElement) }))\r\n      .filter(({ top }) => !Number.isNaN(top))\r\n      .sort((a, b) => a.top - b.top);\r\n    for (const { el, top } of headers) {\r\n      if (top > scrollTop + topOffset + this.options.headerHeight) {\r\n        break;\r\n      }\r\n      header = el;\r\n    }\r\n\r\n    if (!header) return;\r\n    const Header = Quill.import('formats/header') as typeof HeaderWithID;\r\n    const value = Header.formats(header);\r\n    this.setHighlight(value.id);\r\n  }\r\n\r\n  buildList() {\r\n    const root = document.createElement('div');\r\n    root.classList.add(this.bem.b());\r\n    root.addEventListener('click', async (e) => {\r\n      const target = e.target as HTMLElement;\r\n      if (!target || !target.classList.contains(this.bem.be('item'))) return;\r\n      const id = target.dataset.id;\r\n      if (!id) return;\r\n      await this.scrollToHeaderById(id);\r\n      if (isFunction(this.options.onItemClick)) {\r\n        this.options.onItemClick(id);\r\n      }\r\n    });\r\n    return root;\r\n  }\r\n\r\n  async scrollToHeaderById(id: string) {\r\n    const Header = Quill.import('formats/header') as typeof HeaderWithID;\r\n    const headerTags = ensureArray(Header.tagName);\r\n    const selector = headerTags.map(tag => `:scope > ${tag}[${Header.idKey}=\"${id}\"]`).join(', ');\r\n    const targetHeader = this.quill.root.querySelector(selector) as HTMLElement;\r\n    if (targetHeader) {\r\n      const container = this.options.scrollContainer || document.documentElement;\r\n      // if container is window. then need add editor root offsetTop to scrollTo\r\n      let containerOffsetTop = 0;\r\n      if (container === document.documentElement) {\r\n        const rect = this.quill.root.getBoundingClientRect();\r\n        containerOffsetTop = rect.top + window.scrollY;\r\n      }\r\n      const topOffset = await this.options.topOffset();\r\n      const offsetPosition = containerOffsetTop + targetHeader.offsetTop - topOffset;\r\n      container.scrollTo({\r\n        top: offsetPosition,\r\n      });\r\n    }\r\n  }\r\n\r\n  createListItem(id: string, text: string, level: number) {\r\n    const item = document.createElement('div');\r\n    item.classList.add(this.bem.be('item'), `level-${level}`);\r\n    item.dataset.id = id;\r\n    item.textContent = text;\r\n    return item;\r\n  }\r\n\r\n  async hide() {\r\n    if (await this.options.onBeforeHide()) return;\r\n    this.options.container.classList.add(this.options.hideClass);\r\n    this.isHidden = true;\r\n    this.activeToolbarControl();\r\n    this.removeScrollListener();\r\n  }\r\n\r\n  async show() {\r\n    if (await this.options.onBeforeShow()) return;\r\n    this.options.container.classList.remove(this.options.hideClass);\r\n    this.isHidden = false;\r\n    this.activeToolbarControl();\r\n    this.handleScroll();\r\n    this.bindScrollListener();\r\n  }\r\n\r\n  activeToolbarControl() {\r\n    const toolbarModule = this.quill.getModule('toolbar') as TypeToolbar;\r\n    if (!toolbarModule) return;\r\n\r\n    const control = toolbarModule.controls.find(([n]) => n === HeaderList.toolName);\r\n    if (!control) return;\r\n    if (this.isHidden) {\r\n      control[1].classList.remove('ql-active');\r\n    }\r\n    else {\r\n      control[1].classList.add('ql-active');\r\n    }\r\n  }\r\n\r\n  toggleDisplay() {\r\n    return this.isHidden ? this.show() : this.hide();\r\n  }\r\n\r\n  update(addHeaders: (HeaderRecord & { index: number })[], removeHeaders: HTMLElement[], modifiedHeaders: HTMLElement[]) {\r\n    if (!this.root) return;\r\n    for (const header of removeHeaders) {\r\n      const item = this.root.querySelector(`[data-id=\"${header.id}\"]`);\r\n      if (item) {\r\n        item.remove();\r\n      }\r\n    }\r\n\r\n    for (const { index, el, blot } of addHeaders) {\r\n      const { header } = blot.formats();\r\n      this.root.insertBefore(this.createListItem(header.id, el.textContent || '', header.value), this.root.children[index]);\r\n    }\r\n\r\n    for (const header of modifiedHeaders) {\r\n      const listItem = this.root.querySelector(`[data-id=\"${header.id}\"]`);\r\n      if (listItem) {\r\n        listItem.textContent = header.textContent;\r\n      }\r\n    }\r\n  }\r\n\r\n  setHighlight(id: string) {\r\n    if (!this.root) return;\r\n    const item = this.root.querySelector(`:scope > [data-id=\"${id}\"]`);\r\n    if (item) {\r\n      if (this.highlightedItem) {\r\n        this.highlightedItem.classList.remove(this.bem.is('highlight'));\r\n      }\r\n      item.classList.add(this.bem.is('highlight'));\r\n      this.highlightedItem = item;\r\n    }\r\n  }\r\n}\r\n\r\nfunction getAbsoluteTop(element: HTMLElement, container: HTMLElement = document.body): number {\r\n  let offsetTop = 0;\r\n  while (element !== container) {\r\n    if (element === null) {\r\n      // child element is:\r\n      // - not attached to the DOM (display: none)\r\n      // - set to fixed position (not scrollable)\r\n      // - body or html element (null offsetParent)\r\n      return Number.NaN;\r\n    }\r\n    offsetTop += element.offsetTop;\r\n    element = element.offsetParent as HTMLElement;\r\n  }\r\n  return offsetTop;\r\n}\r\n\r\nexport * from './formats';\r\nexport default HeaderList;\r\n"],"mappings":"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"}